{% extends "admin_base.html" %}
{% load static %}


{% block title %}Дашборд{% endblock %}

{% block content %}
<div class="container-fluid">

  <div class="row g-3">
    <div class="col-12 col-md-6 col-xl-3">
      <div class="small-box bg-primary-subtle border border-primary-subtle">
        <div class="inner">
          <h3 class="mb-1">44</h3>
          <p class="mb-0">User Registrations</p>
        </div>
        <div class="icon"><i class="bi bi-person-plus"></i></div>
        <a href="#" class="small-box-footer">Більше <i class="bi bi-arrow-right-short"></i></a>
      </div>
    </div>

    <div class="col-12 col-md-6 col-xl-3">
      <div class="small-box bg-success-subtle border border-success-subtle">
        <div class="inner">
          <h3 class="mb-1">1 250</h3>
          <p class="mb-0">Сеанси</p>
        </div>
        <div class="icon"><i class="bi bi-graph-up-arrow"></i></div>
        <a href="#" class="small-box-footer">Деталі <i class="bi bi-arrow-right-short"></i></a>
      </div>
    </div>

    <div class="col-12 col-md-6 col-xl-3">
      <div class="small-box bg-warning-subtle border border-warning-subtle">
        <div class="inner">
          <h3 class="mb-1">680</h3>
          <p class="mb-0">Нові відвідувачі</p>
        </div>
        <div class="icon"><i class="bi bi-people"></i></div>
        <a href="#" class="small-box-footer">Деталі <i class="bi bi-arrow-right-short"></i></a>
      </div>
    </div>

    <div class="col-12 col-md-6 col-xl-3">
      <div class="small-box bg-danger-subtle border border-danger-subtle">
        <div class="inner">
          <h3 class="mb-1">12%</h3>
          <p class="mb-0">Bounce Rate</p>
        </div>
        <div class="icon"><i class="bi bi-activity"></i></div>
        <a href="#" class="small-box-footer">Деталі <i class="bi bi-arrow-right-short"></i></a>
      </div>
    </div>
  </div>

  <!-- Графіки -->
  <div class="row g-3">
    <div class="col-12 col-xl-8">
      <div class="card h-100">
        <div class="card-header"><h5 class="card-title mb-0">Сеанси</h5></div>
        <div class="card-body"><div id="sessions-line"></div></div>
      </div>
    </div>
    <div class="col-12 col-xl-4">
      <div class="card h-100">
        <div class="card-header"><h5 class="card-title mb-0">Канали</h5></div>
        <div class="card-body"><div id="channels-pie"></div></div>
      </div>
    </div>
  </div>

  <!-- Карта + невеликі графіки -->
  <div class="row g-3 mt-1">
    <div class="col-12 col-xl-6">
      <div class="card h-100">
        <div class="card-header"><h5 class="card-title mb-0">Географія відвідувачів</h5></div>
        <div class="card-body" style="height: 360px;">
          <div id="world-map" style="height: 100%;"></div>
        </div>
      </div>
    </div>
    <div class="col-12 col-xl-6">
      <div class="card h-100">
        <div class="card-header"><h5 class="card-title mb-0">Статистика</h5></div>
        <div class="card-body">
          <div id="mini-1"></div>
          <div id="mini-2" class="mt-3"></div>
          <div id="mini-3" class="mt-3"></div>
        </div>
      </div>
    </div>
  </div>




</div>
{% endblock %}

{% block extra_js %}
<script>
  // Лінійний графік (ApexCharts)
  new ApexCharts(document.querySelector("#sessions-line"), {
    series: [
      { name: "Сеанси", data: [420, 380, 460, 520, 480, 510, 590] }
    ],
    chart: { type: 'line', height: 260, toolbar: { show:false }},
    stroke: { curve: 'smooth', width: 3 },
    xaxis: { categories: ['15 сер','18 сер','22 сер','25 сер','28 сер','31 сер','03 вер'] },
    colors: ['#0d6efd'],
    dataLabels: { enabled:false }
  }).render();

  // Кругова діаграма
  new ApexCharts(document.querySelector("#channels-pie"), {
    series: [41, 18, 12, 11, 9, 9], // приклад: Organic, Paid, Referral, Social, Direct, Other
    labels: ['Organic','Paid','Referral','Social','Direct','Other'],
    chart: { type: 'donut', height: 260 },
    dataLabels: { enabled: false },
    colors: ['#0d6efd','#20c997','#ffc107','#d63384','#6c757d','#fd7e14']
  }).render();

  // Міні-спарклайни (опціонально)
  function spark(selector, data){
    new ApexCharts(document.querySelector(selector),{
      series:[{ data }],
      chart:{ type:'line', height:60, sparkline:{enabled:true}},
      stroke:{ width:2 }, colors:['#0d6efd'], dataLabels:{enabled:false},
      tooltip:{ enabled:false }
    }).render();
  }
  spark('#mini-1',[25,40,36,52,48,60,58]);
  spark('#mini-2',[10,22,18,27,35,30,45]);
  spark('#mini-3',[5,12,9,15,13,18,22]);

  // Карта (jsVectorMap)
  const map = new jsVectorMap({
    selector: '#world-map',
    map: 'world',
    zoomOnScroll: false,
    markers: [
      { name:'Kyiv', coords:[50.45, 30.52] },
      { name:'Warsaw', coords:[52.23, 21.01] },
      { name:'Berlin', coords:[52.52, 13.40] }
    ]
  });
</script>
{% endblock %}


